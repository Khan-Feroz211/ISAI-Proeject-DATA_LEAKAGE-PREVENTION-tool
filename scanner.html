# Create scanner.html
cat > templates/scanner.html << 'HTML_EOF'
{% extends "base.html" %}

{% block title %}Security Scanner - DLP Security Scanner{% endblock %}

{% block content %}
<div class="scanner-page">
    <div class="header">
        <h1>üîç Advanced Security Scanner</h1>
        <p>Comprehensive file scanning with sensitive data detection</p>
    </div>

    <div class="card">
        <h2>Custom Path Scanner</h2>
        <div class="scanner-controls">
            <input type="text" id="customPath" placeholder="/path/to/scan" value="/home" class="path-input">
            <select id="scanType" class="scan-select">
                <option value="quick">Quick Scan (15 files)</option>
                <option value="deep">Deep Scan (50 files)</option>
            </select>
            <button class="btn btn-success" onclick="startCustomScan()">
                üöÄ Start Custom Scan
            </button>
        </div>
    </div>

    <div class="card">
        <h2>Quick Scan Locations</h2>
        <div class="quick-scans">
            <button class="btn" onclick="scanLocation('quick', '~')">
                üè† Home Directory
            </button>
            <button class="btn" onclick="scanLocation('quick', '/tmp')">
                üì¶ Temp Directory
            </button>
            <button class="btn" onclick="scanLocation('quick', '/var/log')">
                üìã Log Directory
            </button>
            <button class="btn btn-warning" onclick="scanLocation('deep', '/etc')">
                ‚öôÔ∏è /etc (Configs)
            </button>
            <button class="btn btn-danger" onclick="scanLocation('deep', '/')">
                üíª Root Directory
            </button>
        </div>
    </div>

    <div class="card">
        <h2>Scan Results</h2>
        <div id="scannerResults">
            <div class="no-results">Scan results will appear here...</div>
        </div>
    </div>
</div>

<script>
function startCustomScan() {
    const path = document.getElementById('customPath').value;
    const scanType = document.getElementById('scanType').value;
    if (!path) {
        alert('Please enter a path to scan');
        return;
    }
    scanLocation(scanType, path);
}

function scanLocation(scanType, path) {
    document.getElementById('scannerResults').innerHTML = 
        `<div class="loading">
            <div class="loading-spinner"></div>
            <div>üîç Scanning ${path} (${scanType} scan)...</div>
            <div>Please wait while we analyze the files...</div>
        </div>`;

    fetch('/api/scan', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({path: path, scan_type: scanType})
    })
    .then(r => r.json())
    .then(data => {
        displayDetailedResults(data);
    })
    .catch(err => {
        document.getElementById('scannerResults').innerHTML = 
            '<div class="error">Error: ' + err + '</div>';
    });
}

function displayDetailedResults(data) {
    let html = `<div class="scan-summary">
        <h3>Scan Results: ${data.path}</h3>
        <div class="summary-stats">
            <div class="stat"><strong>Scan Time:</strong> ${data.scanned_at}</div>
            <div class="stat"><strong>Total Files:</strong> ${data.total_files}</div>
            <div class="stat"><strong>Sensitive Files:</strong> ${data.sensitive_files}</div>
            <div class="stat"><strong>Critical Risks:</strong> <span class="risk-critical">${data.critical_risk_files}</span></div>
            <div class="stat"><strong>High Risks:</strong> <span class="risk-high">${data.high_risk_files}</span></div>
        </div>
    </div>`;

    if (data.findings && data.findings.length > 0) {
        html += `<div class="detailed-findings">`;
        data.findings.forEach(item => {
            const riskClass = item.risk_level || 'low';
            html += `<div class="detailed-finding finding-${riskClass}">
                <div class="file-header">
                    <strong>üìÑ ${item.name}</strong>
                    <span class="file-meta">${item.size_readable} | ${item.modified} | Perm: ${item.permissions}</span>
                </div>
                <div class="file-path">${item.path}</div>`;
            
            if (item.issues && item.issues.length > 0) {
                html += `<div class="file-issues">`;
                item.issues.forEach(issue => {
                    html += `<div class="detailed-issue issue-${issue.risk}">
                        <span class="issue-type">${issue.type}</span>
                        <div class="issue-message">${issue.message}</div>`;
                    if (issue.sample) {
                        html += `<div class="issue-sample">Sample: ${issue.sample}</div>`;
                    }
                    html += `</div>`;
                });
                html += `</div>`;
            } else {
                html += `<div class="no-issues-file">‚úÖ No security issues found in this file</div>`;
            }
            html += `</div>`;
        });
        html += `</div>`;
    } else {
        html += `<div class="no-issues">üéâ No security issues found in any scanned files!</div>`;
    }

    document.getElementById('scannerResults').innerHTML = html;
}
</script>

<style>
.scanner-controls {
    display: flex;
    gap: 10px;
    align-items: center;
    flex-wrap: wrap;
}

.path-input {
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 6px;
    width: 300px;
}

.scan-select {
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 6px;
    background: white;
}

.quick-scans {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
}

.scan-summary {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 8px;
    margin-bottom: 20px;
}

.summary-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 10px;
    margin-top: 15px;
}

.stat {
    padding: 10px;
    background: white;
    border-radius: 4px;
}

.detailed-findings {
    max-height: 600px;
    overflow-y: auto;
}

.detailed-finding {
    padding: 20px;
    margin: 15px 0;
    border-radius: 8px;
    border-left: 4px solid;
}

.file-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}

.file-meta {
    color: #666;
    font-size: 0.8em;
}

.file-path {
    color: #666;
    font-size: 0.8em;
    margin-bottom: 15px;
    font-family: monospace;
}

.file-issues {
    margin-top: 10px;
}

.detailed-issue {
    padding: 10px;
    margin: 8px 0;
    background: rgba(0,0,0,0.05);
    border-radius: 4px;
    border-left: 3px solid;
}

.issue-type {
    font-weight: bold;
    text-transform: uppercase;
    font-size: 0.8em;
    display: block;
    margin-bottom: 5px;
}

.issue-message {
    margin-bottom: 5px;
}

.issue-sample {
    font-family: monospace;
    font-size: 0.8em;
    color: #666;
    background: rgba(0,0,0,0.1);
    padding: 5px;
    border-radius: 3px;
}

.no-issues-file {
    text-align: center;
    padding: 20px;
    color: #28a745;
    font-style: italic;
}
</style>
{% endblock %}
HTML_EOF